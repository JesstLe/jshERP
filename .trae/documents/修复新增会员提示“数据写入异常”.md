## 初步判断（为什么会出现“数据写入异常”）
- 会员新增走的是前端 [MemberModal.vue](file:///Users/lv/Workspace/erp/jshERP-web/src/views/system/modules/MemberModal.vue) 调用 `POST /supplier/add`。
- 后端 [SupplierService.insertSupplier](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/service/SupplierService.java#L149-L167) 在写库或写日志发生异常时，会统一抛出 `BusinessRunTimeException(301,"数据写入异常")`（见 [JshException.writeFail](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/exception/JshException.java#L19-L24)）。
- 目前异常被统一包装，UI只看到“数据写入异常”，看不到具体原因（例如：缺少必填字段、字段长度超限、数据库表默认值缺失、tenantId/deleteFlag 默认值问题等）。

## 我将如何定位并修复（你确认后执行）
### 1）复现并拿到真实异常原因
- 在本地用同样的接口 `POST /supplier/add` 发送和页面一致的 payload（会员卡号/联系人/手机号等），观察返回。
- 从后端运行日志中抓取完整堆栈（GlobalExceptionHandler 会打印堆栈），定位到底是：
  - 数据库约束问题（NOT NULL/无默认值/字段长度/类型不匹配）
  - 业务代码 NPE（例如 userInfo 为空、日志记录失败等）

### 2）针对“新增会员”做兜底防御（保证不再写入异常）
- 在 `insertSupplier` 中补齐安全默认值（不改变业务含义，但能避免常见写库失败）：
  - `deleteFlag` 为空时强制设为 `'0'`
  - `advanceIn` 为空时设为 `0`
  - `type` 为空时直接拒绝并返回明确提示（避免写入脏数据）
  - `tenantId` 为空时按当前登录用户推断（优先 `userInfo.tenantId`）
- 如异常来源是“日志写入失败导致事务回滚”，将日志写入改为：
  - 失败不影响主业务（记录 warn，不回滚会员新增）或把日志移到事务外

### 3）前端错误提示优化（让用户看到明确原因）
- 会员新增失败时，优先展示 `res.data.message`；若没有则展示 `res.data` 或通用提示，避免空提示。
- 可选：在表单端加更强校验（手机号长度、会员卡号规则），减少后端报错概率。

### 4）验证
- 在“会员信息”页新增：
  - 仅填会员卡号
  - 填姓名+手机号
  - 填所有字段
- 都能成功写入并在列表即时看到；失败时能看到明确原因（不再只有“数据写入异常”）。