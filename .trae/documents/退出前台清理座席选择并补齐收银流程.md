## 现状判断（为什么你会觉得没清台/流程不完整）
- 当前“退出前台”只是 `$router.push('/')`（见 [Cashier.vue](file:///Users/lv/Workspace/erp/jshERP-web/src/views/cashier/Cashier.vue#L14-L17)），**不清理当前选择/弹窗状态，也不调用后端清台接口**。
- 收银弹窗的“主单信息/会员刷卡/结算”三个 Tab 目前是占位提示（见 [CashierDeskModal.vue](file:///Users/lv/Workspace/erp/jshERP-web/src/views/cashier/modules/CashierDeskModal.vue#L18-L113)）。
- 系统里存在两种“清台”含义：
  1) **UI 清空选定**：取消选中的座席/关闭弹窗、清空 currentSeat/currentSession（仅前端状态）。
  2) **业务清台**：关闭会话并把 seat.status 从 1 置 0（后端 `POST /cashier/session/close`）。这个会丢弃未结算会话的“占用状态”，因此不建议在“退出前台”里无提示自动执行。

## 目标
- “退出前台”时**至少自动取消座席选定（UI 清空）**，避免离开页面后仍残留选中态。
- 如果当前座席存在 OPEN 会话，则在退出时给出明确分支：
  - 仅退出（保留会话/不清台）
  - 去结算（完成支付/清台）
  - 强制清台（关闭会话，明确告知未结算数据如何处理）
- 补齐“主单信息 / 会员刷卡 / 结算”三块的可用闭环。

## 实施方案
### 1）退出前台：默认 UI 清理 + 有会话时弹确认
- 改造 [Cashier.vue](file:///Users/lv/Workspace/erp/jshERP-web/src/views/cashier/Cashier.vue#L14-L17) 的“退出前台”点击事件：
  - 若当前没有打开收银弹窗/未选座席：直接退出，但也清理 `currentSeat/currentSession/deskSeat/deskSession/deskVisible`。
  - 若存在座席且能查到 OPEN 会话：弹窗提供 3 个动作：
    1) 返回继续
    2) 仅退出前台（不清台；仅清理前端状态并跳转）
    3) 去结算（打开结算 Tab 并引导完成结算后自动清台）
    4) 强制清台（调用 `POST /cashier/session/close`，再退出）
- 同时在 `handleDeskClose()` 里补齐对 `currentSeat/currentSession` 的清理（避免只清 desk* 导致状态残留）。

### 2）主单信息 Tab：展示并可编辑主单字段
- 在 [CashierDeskModal.vue](file:///Users/lv/Workspace/erp/jshERP-web/src/views/cashier/modules/CashierDeskModal.vue) 的 `bill` Tab 中补齐：
  - 展示：座席、会话号、开台时间、操作员、门店、备注、已绑定会员
  - 支持编辑“备注/人数/其他主单字段”（若目前表结构没有就先只做 remark）
- 后端若缺接口：新增 `PUT /cashier/session/update`（或在现有 `CashierSessionService` 中增加 update 方法）用于更新 remark。

### 3）会员刷卡 Tab：会员查询 + 绑定会话
- 前端实现：
  - 输入框（刷卡/手机号/姓名关键词）→ 调用 `GET /supplier/list` 进行模糊搜索（按 `telephone/phoneNum/supplier` 等字段）
  - 选择会员后调用 `PUT /cashier/session/bindMember`（已存在，见 [CashierSessionController.bindMember](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/controller/CashierSessionController.java#L89-L104)）
  - 绑定成功后刷新 `cashier/session/detail`，左侧标题显示会员信息
- 若你们业务要“仅会员类型可绑定”：在后端 `bindMember` 时校验 `Supplier.type`（例如必须是“会员”），并在前端搜索时加 type 过滤。

### 4）结算 Tab：预览 + 确认结算 + 是否清台
- 直接复用后端现有接口：
  - `GET /cashier/settlement/preview?sessionId=` 展示项目金额、产品金额、合计
  - `POST /cashier/settlement/checkout {sessionId, clearSeat}` 执行结算并（可选）清台
- 前端结算页补齐：
  - 合计展示、是否清台开关、确认结算按钮
  - 结算成功后关闭弹窗、刷新座席列表
- 后续扩展（可选）：增加“支付方式/实收/找零/支付流水”需要新表与接口；本轮先把“能结算并清台”的闭环跑通。

## 验证方式
- 选中占用座席打开收银弹窗后点击“退出前台”：出现 仅退出/去结算/强制清台 的选择；选择“仅退出”后页面状态清空但座席仍占用。
- “会员刷卡”绑定后，左侧主单区域出现会员信息，且 `cashier/session/detail` 返回 member 不为空。
- “结算”页能看到预览金额并结算成功；选择清台后座席状态变空闲。

确认后我会按以上 1→4 逐项落地（含前后端必要接口补充），并在页面上把“主单信息/会员刷卡/结算”从占位提示替换为可用流程。