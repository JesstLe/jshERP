## 原因定位
- 侧边栏菜单来自接口 `/function/findMenuByPNumber`，后端会按“用户角色(Role)→角色功能(RoleFunctions)”过滤菜单。
- 叶子菜单是否显示只看 `RoleFunctions.value` 是否包含对应 `funId`（形如 `[263]`）：[FunctionController.java](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/controller/FunctionController.java#L195-L225)
- 子账户还会额外受到“租户功能上限”限制：即便子账户角色里有该 `funId`，只要租户的功能集合里没有，也会被过滤：[FunctionController.java](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/controller/FunctionController.java#L198-L223)
- 因此 test123 看不到“收银”，本质是：它所属角色（以及/或者租户的角色）没有勾选收银相关 funId（如 `/cashier/index`、`/service/item/manage`），导致父菜单“收银”因无子项被整体隐藏。

## 修复目标
- “收银”作为所有账户的基础能力：无论子账户属于什么角色，都能看到“收银”菜单及其必要子菜单。
- 同时确保你新加的“顾客看板/顾客报表”（已挂在收银下）不会因为权限缺失而对子账户消失。

## 修复方案（两层兜底：数据层 + 代码层）
### 1）数据层：给所有角色补齐收银相关 funId（一次性修复现有租户/角色）
- 新增一份升级脚本（幂等）：
  - 通过 `jsh_function.url` 动态取 id：`/cashier`、`/cashier/index`、`/service/item/manage`、`/customer/dashboard`、`/customer/report`
  - 对 `jsh_user_business` 中所有 `type='RoleFunctions'` 且未删除的记录，逐个把这些 funId 追加到 `value`（不存在才追加）
  - 这样所有现有角色都会拥有“收银”及看板/报表入口。
- 同步更新初始化库 [jsh_erp.sql](file:///Users/lv/Workspace/erp/jshERP-boot/docs/jsh_erp.sql)：确保新装/重置库也天然包含这些权限。

### 2）代码层：防止未来新建角色/误操作导致收银再次消失
- 在菜单过滤处增加“基础功能白名单”兜底：
  - 当 Function 的 `url` 属于 `/cashier` 模块（含 `/cashier/index`、`/service/item/manage`）以及你新增的 `/customer/dashboard`、`/customer/report` 时：
    - 跳过 `RoleFunctions` 的包含校验（保证所有账户可见）
    - 同时对子账户跳过“租户功能上限”校验（否则仍可能被拦）
  - 修改点集中在：[FunctionController.java](file:///Users/lv/Workspace/erp/jshERP-boot/src/main/java/com/jsh/erp/controller/FunctionController.java#L195-L225)

## 验证方式
- 用 test123 登录：左侧必须出现“收银”，展开包含“前台收银/服务项目管理/顾客看板/顾客报表”。
- 调用 `/function/findMenuByPNumber`（带 userId）确认返回树中含 `/cashier` 及其 children。

确认后我会按上述方案落地：新增升级 SQL + 更新初始化 SQL + 修改后端菜单过滤并本地验证子账户可见。